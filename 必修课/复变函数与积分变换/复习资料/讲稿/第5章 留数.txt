各位同学大家好，本节课我们来学习复变函数中的留数。学习本节课之前，请先确保完成上一章——级数的学习。

第五章留数实际上是第三章和第四章内容的综合，它为我们提供了又一种有效的求复变函数积分的方法。
在学习第三章的时候，我们已经知道如果一个复变函数的积分能使用科西古萨基本定理来求那么无疑是非常友好的，我们不需要做任何计算。
然而很多时候仅仅是因为在积分曲线内部有函数的几个孤立奇点，这条定理就不再成立了。我们有没有办法解决这件事儿呢？
根据复合闭路定理，我们知道f(z)在曲线c的积分，可以化作围绕着这些奇点的小曲线C1,C2,C3上的积分之和。
也就是说，如果函数f(z)在曲线C内部有有限个孤立奇点，那么它沿曲线C的积分就等于在环绕各孤立奇点的曲线上求它的积分之和。

然而在第三章中，针对函数在曲线内部有不解析区域的积分，我们只学了柯西积分公式和高阶导数公式这两种求特殊形式函数的积分的办法。
那如果这个函数给的更一般些，没有办法用它们俩计算，我们要怎么办呢？
在上一章中我们学习的洛朗级数，我们可以将一个有奇点的函数，在这个奇点的邻域内展开成洛朗级数，而这些曲线C1,C2,C3自然又是在这些奇点的邻域里的。
因此，我们就可以把函数在这条曲线上的取值表示成它的洛朗级数的取值。
而洛朗级数又是可以逐项积分的。因此求f(z)在曲线C1,C2,C3上的积分，实际上就可以等同于求他们的洛朗级数在这曲线上的积分。
我们来考虑函数f(z)的洛朗级数。写出它的洛朗展开式，并且两边同时沿曲线C1积分。这里我们可以不用急着写出洛朗级数的系数。
因为根据我们第三章中的那个例题中的重要结论，你积完分以后就会发现负幂次项中，除了负一次项以外，结果全部都变成了0。而正幂次项其实就是n取-1,-2等等，因此也全都变成了0。
于是我们的这个曲线积分只剩下了c-1×2πi，也就是2πi倍的洛朗级数的负一次幂项系数。
我们把这个负一次幂项系数就称作函数z在这个奇点z0处的留数，因为积分的时候，其他的系数都消失了，只留下来了它一个，所以叫留数。
这样，如果我们想求围绕着奇点z1的曲线C1的积分，只需要求出在它附近的洛朗展开式中的负一次幂项系数，也就是它在这个点处的留数，然后乘2πi就可以求出这个积分值了。
求出了个各个奇点附近的留数值，我们就可以把它们全部相加起来。根据刚才提到的复合闭路定理，我们把曲线C的积分转化成围绕奇点的小曲线C1,C2,C3的积分，
又把这些围绕小曲线的积分转化成留数，因此在曲线C上的积分就等于这些留数的和乘以2πi。这就是所谓的留数定理，它实际上就是复合闭路定理的具象体现罢了。
复合闭路定理只告诉我们，内有若干奇点的曲线的积分，可以转化成围绕各个奇点的曲线的积分，但没有告诉我们转化以后怎么计算。而留数定理则是完善了这一后续过程。

然而我们知道，要求一个奇点处的留数，就要把函数在这个奇点附近洛朗展开，如果奇点个数比较多，那么这一工作还是相当繁琐的。有没有其他办法来求我们的留数呢？
我们在上一节课中提到，洛朗级数的负幂项部分被称为主要部分，这正是因为，在不同的奇点附近将函数洛朗展开，得到的负幂项部分会有所不同。
也就是说，奇点类型将会影响洛朗级数的负幂项部分，当然也影响到它的负一次幂项，也就是留数。
根据奇点处的洛朗展开式的不同，我们将孤立奇点分为以下的三类，可去奇点，极点和本性奇点。
这里额外提一句概念，并非所有函数的奇点都是孤立的。也就是说某一个函数的某个奇点的邻域内，可能还有其他的奇点，哪怕这个邻域无限的小，都还是存在奇点，那么这样的奇点就不是孤立的。
不过因为它的性质不太好，我们一般也不研究它，大家只需要知道这个概念就可以了。
说回我们的孤立奇点。奇点的类型和它们图中展示的性质都是相互等价的。
也就是函数在可去奇点的极限存在，在可去奇点附近的洛朗展开式没有负幂项，在可去奇点上的留数一定为0。
函数在极点的极限不存在但为无穷，在极点附近的洛朗展开式有有限项负幂项，在极点上的留数与它的级有关。
函数在本性奇点的极限不存在也不为无穷，也就是函数从不同方向接近奇点，函数值不会变化到同一个值；在本性奇点附近的洛朗展开式有无穷多负幂项，在本性奇点上的留数一般只能洛朗展开求。
啊，这样我们突然给了大家一堆概念和一堆条件。既没有解释它的来源，也没有向大家证明，这是因为说起来还是比较复杂，并且在考试的时候，我们只需要做到会用就好。
总之，这几个概念还是请大家一定记下来。
奇点的概念大概与实函数中的连续点有一些类似。可去奇点与可去间断点相仿，在这个点补充定义，函数就解析/连续了。极点与无穷间断点相仿，极限都趋于无穷。
那么搞清楚奇点的分类是为了干什么呢？当然是为了求留数，我们刚才已经提到，不同的奇点附近的洛朗展开式各不相同，它们的留数当然各不相同。

可去奇点是我们最喜欢的一类奇点，因为函数在它可去奇点上的留数一定为0。
那么怎样判断一个点是不是函数的可去起点呢？首先这个点得是它的奇点，例如说让分母为零的点之类的。然后你可以判断函数在这个点的极限是否为常数。
高等数学上册中我们都学过求函数极限的方法，最简单的办法就是洛！也就是洛必达法则。
这里我们不加证明的指出，复变函数中洛必达法则仍然适用，只不过多了一些额外的要求，要求分子分母都是在奇点的去心邻域内解析的函数。
一般这种条件都是满足的，因为函数在孤立奇点附近肯定是解析的，不孤立的奇点我们不研究它。此外，洛必达法则仍然只适用于0/0或无穷/无穷型的未定式。
只要你能洛出一个常数来，那么它的奇点类型就是可去奇点。此外，另一种求极限的方法——等价无穷小也是适用的，只不过要注意，等价无穷小只能运用于奇点为0的情况。
它的名字毕竟叫无穷小，那趋于0才是无穷小啊。你假如说z=1是它的奇点，然后你要用等价无穷小，那显然是不对的，趋于1可不是无穷小啊。
总之只要你能想办法把它的极限求出来，并且求出了一个常数。那么就说明它是可去起点。
本性奇点是我们不太喜欢的一类奇点，它的性质很古怪，有无穷多负幂项，像这种东西一般你求极限也是没法求的，因为它的极限根本就不存在。
因此如果你怀疑一个函数的某个起点是本性起点，那么你就可以直接把它洛朗展开来看看。
一般我们常见的四个能够泰勒展开的函数，也就是指数函数，正余弦函数，以及1/(1-z)这个函数，
你要把原来z的位置换成1/z之类的，那么你一般就要怀疑他是不是本性奇点了。比如说e^(1/z)，sin(1/(z-1))，cos(1/z^2)这样的。
因为你想啊，原来这些函数的泰勒展开有无穷多正幂项，你把倒数放上去，那不就变成无穷负幂项了吗？
如果你判断了它是本性奇点，那么你直接把负一次幂项的系数拿出来用就好了。
大家要注意啊，是负一次幂项系数，不是“第一个负幂项的系数”。有的时候它可能没有负一次幂，直接就是-2次幂了，那么负一次幂项系数自然为0。

下面就是我们考的最多的一类孤立奇点，极点，因为可去奇点的留数一定为零，本性奇点的留数你直接洛朗展开，它们都没有什么可考的。但是极点呢，它就有很多花样。
你可以像图中给的极点的定义式，把f(z)表示成图中这个函数的形式。
你也可以用求极限的办法来判断它是不是极点。但是一般这两种方法我们都不使用，大家知道一下就好。
另外，我们的极点还有“级”的概念，大致可以理解为函数走向无穷的速度是快还是慢。例如说1/z和1/z^2，在z趋于0时后者显然趋于无穷的快一些，所以z=0是后者的2级极点，是前者的1级极点。
当然它有更严谨的数学定义，我们这里也不深究，大家只需要知道这个级会影响极点处的留数就可以了。
这样看来，想办法确定一个极点的级次，我们才能求出它的留数来，然而求极限的办法只能确定它是一个极点，并不能确定极点的级次到底是多少。怎么办呢？
一般的来说，一个函数有极点，通常是分母不为零造成的。那么分母为不为零，实际上就是求它分母的零点。
因此函数的零点和极点是有关系的。课本上给的函数零点的定义，又把f(z)表示成了另一个函数，什么(z-z0)^m啥啥的，实际上根本没有必要。只是数学上这么严谨的说明罢了。
零点就是使函数值为零的点，没有任何特别之处。不过在这里我们的零点有级的概念。
这个零点的级，它可能与实变函数中方程的重根类似。比如说(x-1)^2=0，这个函数(x-1)^2的零点是x=1，那么x=1是这个方程(x-1)^2=0的2重根。
我们这里就管它叫函数的2级零点。一般来说，使有理n次方项为0的零点就是n级零点，比如说(z-2)^10，那么2就是它的10级零点。
但是大家要注意和平方差公式，或者说多项式的乘积区分啊。比如说z^2-1，那么它有两个零点+1和-1，千万不要以为都是它的2级零点啊。
因为z^2-1=(z+1)(z-1)，而1是z-1的零点却不是z+1的零点，-1是z+1的零点而不是z-1的零点，因此它们都是(z+1)(z-1)的1级零点。
类似这样的关系，我们后面经常会用到。
当然，我们有时候遇上的函数并不像多项式这么简单。如果遇上一些比较复杂的函数，要判断它零点的级次，那么一般用求导的方法来判断。
也就是如果一个点是这个函数的零点，那么你就对它求导，看这个点还是不是它导数的零点。当你第一次求出来导数不为0的时候，求导的次数就是零点的级次。
那么我们都0的倒数就是无穷，所以如果z0是函数f(z)的m级零点，那z0就是f(z)的倒数1/f(z)的m级极点。
这是我们经常会用到的一个判断极点级数的办法。当然实际上这个办法我们后面也不是很常用，大家做个了解就可以了。
从概念上来说，我们就有了这么几种来判断孤立奇点性质的方法。但是上述提到的这些方法其实都不实用。如何在考试中快速的判断出奇点的类型呢？如果它是极点，如何得到它的级次呢？

我们给出大家如下的论断。对一般的函数来讲，以下的论断都是成立的，大家可以直接去使用，无需在考试中证明。
其中我们最常用的是右边这列的第一条和第三条性质。
第一条的性质意思是，如果一个点z0同时是f(z)和g(z)的零点。那么f(z)和g(z)乘在一起，这个点z0仍然是它们乘积的零点，
并且级次为它们俩原本级次的和。要注意这个零点必须同时是他们的零点，刚才平方差公式的例子我已经讲过了。
第三条性质是我们最最常用的性质。如果我们遇到了一个分式函数，它因为分母为0或者分子分母同时为0，导致出现了孤立起点，那么第三条性质可以判断这奇点是可去奇点还是极点，
并且如果是极点，可以直接指出它的级次。
用法是这样的，首先我们要先求出分母的零点，就是让分母等于0，看z等于几，也就是求整个分式函数的奇点。
然后看这几个零点分别是分母的几级零点，是分子的几级零点。当然很多时候它不是分子的零点，那么就认为是0级零点。
那求零点级次的方法，我们前面已经提到了，就是求导嘛。这样你判断出分母和分子的零点级次之后，只要用它们的级次下减上，就可以得到极点的级数了。
如果减完是一个正数，就说明这个点确实是这个分式函数的极点，而且级次就是这个差值。如果减完得到0或者是负值，说明这个点是它的可去奇点。

要注意这个步骤啊，我们要先求出分式函数的所有奇点，也就是让分母为0。当然分子首先得是解析的啊。然后逐个判断这些奇点。
比如说我求一个函数f(x)/g(x)，它的奇点有1,2,3三个。那么我就要先判断，1是分母的几级零点？是分子的几级零点？然后我就能得到，1是整个分式的什么奇点。
然后我在判断，2是分母的几级零点？是分子的几级零点？然后我就知道2是什么奇点。过程就是这样子的。你每次判断只能让分子分母取同一个点，大家不要混在一起了。
下面我们来看几个例子。


前面我们已经说到极点处的留数与极点的级次有关。具体是怎么个有关法呢？我们不加证明的给出如下两个计算极点处留数的规则。
如果一个有理分式函数，它有一个1级极点，并且按照我们讲的求极点方法，是由（0级零点/1级零点）=1级极点这种形式得到的，那么它的留数按照这种方式计算：
分子不变，分母求导，然后把极点带进这个新的函数去。大家要注意这种方法，只能适用于非零点/1级零点得到的1级极点。
假如说他是1级零点/2级零点得到的1级极点，那就不能用这种方法了。
第二种方法要更普适一些，如果已经知道了极点的级次，那么这个极点处的留数可以按如图的公式计算。这个式子一看很复杂，我们一步一步来看它。
首先我们要给原来的函数乘上一个(z-z0)^m，这里的z0就是函数的极点，m就是极点的级次。
然后我们要对这个整体求m-1阶导数。求完导以后呢，我们要求这个结果趋于z0的极限，最后乘上一个系数1/(m-1)!。
大家一看，哇这要求高阶导数还要求极限，好复杂啊。事实上确实是如此的，但是一般而言，我们遇到的极点级次都不会太高。最多就是求一阶导数，大家也不用太担心。
求极限，我们一般也不是很难，要么这个极限直接就是个定值，要么它可以洛。总之肯定是能求的，只是需要大家耐心一点。
最后要提醒大家的是，有时候这个极点的级次确实很高。那么我们就要考虑改用别的方法，可能这个时候直接求洛朗展开式要更方便一些。
总而言之，只要求出了留数，我们就可以求积分了。只要在留数的和前乘个2πi就好了。下面我们来看几个例子。

前面我们提到的奇点都在有限复平面上，这里稍微给大家提一下无穷远点留数的概念。
因为无穷原点本来在我们的练习册上是画星号的内容。本年度的考试可能也不会涉及，但是有时候他会给计算带来方便，我们稍微给大家讲一下，PPT上没有，大家可以打开课本来看一看。
所谓无穷远点的留数就是直接把自变量z换元成1/t，这样当t趋于0时为自然就趋于无穷了。
也就是说你拿到一个函数f(z)，你想知道无穷远点是不是这个函数的奇点呢？那你就把函数里面的所有z都换成1/t，然后来看一看t=0是不是换元后函数的奇点。
如果是这样，那么就说明无穷远点是原来函数f(z)的奇点。
至于无穷远点的留数是多少，我们仍然不加证明的给出大家这样的规则：
函数f(z)在无穷远点处的留数Rex[f(z)，∞]，等于函数f(1/z)乘以1/z^2后，在z=0点处的留数的变号，也就是-Res[f(1/z)·(1/z^2)，0]。
就是说计算函数f(z)在无穷远点处的留数时，我们只需要将f(z)中的所有z都先写成1/z。然后给他再乘上1/z^2，最后求这个新的函数在z=0点处的留数，再变号就可以了。
为什么要讲在无穷远点处的留数呢？我们有这样的定理：函数在扩充复平面上所有点处的留数之和必为零。注意，这里是扩充复平面，必须要包括无穷远点，否则这条定理将不再成立。
我想这条性质的用处，大家应该已经可以想到了。假如说有一个函数，它的其他极点都比较正常，唯独有一个极点的级次很高，例如说分母上有(z+1)^10之类的东西，那么你想求它的留数就非常困难。
然而如果它在无穷远点的留数比较好求，那么我们就可以考虑求出它在无穷远点处的流数。这样所有留数的和等于0，这个点的留数不就知道了吗？
这个定理有时是很有用的，我不知道考试会不会出，大家就了解一下吧，至少遇到一些级次很高的的极点的时候还知道怎么处理。

本课的最后我们来了解留数在求解实变函数定积分上的应用。我们知道实数也是复数的一种，求实变函数的定积分，可以看作是复数仅在实轴上活动得到的积分。
然而复数可以在复平面上活动，相当于直接把一维的问题拔高到二维来看。因此’有些时候用复变函数计算实轴上的定积分。要比我们在实数域内考虑这个东西简单的多。
这就好像是你家门口有一条大马路经常堵车，你每天去上学都要被堵上好一阵子。然而某一天你的车解锁了穿墙术，可以在你家周围的街区内任意的穿梭。
这样就把一条一维的马路拓展到了二维的区域，就方便了很多。
当然数学没有这么简单，我们至少要把这个实函数与复变函数联系在一起才行。一般而言，以下三种形式的定积分可以比较容易的与复变函数关联，并且由复变函数积分求解。
分别是有理三角函数的全周期积分，也就是被积函数是完全由三角函数组成的函数，积分区间是一个周期。
有理分式函数的无穷广义积分，也就是被积函数是完全由多项式组成的函数，积分区间是对称的无穷区间。
一般而言，广义积分的值需要判断其是否收敛，也就是说你在无穷区间上做积分，如果这个被积函数的值不趋于零，那么你相当于在一直累加一堆不为0的数，加出来的结果自然是无穷，
不会收敛于一个确定的值。不过复变在考试中给出的函数，积分一般都是存在（收敛）的。所以不用考虑这个问题，会求就完事儿了。
有理函数乘三角函数的无穷广义积分，也就是整个式子完全由多项式和三角函数组成积分区间，仍然是对称的无穷区间。
要注意的是，这里乘的三角函数一般而言只能乘一种。也就是你不能把sinx跟cosx乘在一起求。如果乘在一起了，就要考虑能不能用三角公式把它们变成没乘在一起的，比如说sinxcosx，
你要把它变成(1/2)sin2x这种东西。或者要把它们利用裂项等技巧拆开成两个式子，总之一个式子里不能同时有sinx和cosx。不过一般不会考这么难，题目会直接给你合适的形式。
那这些积分怎么转化成复变函数的积分呢？我们分别来看一看。
首先第一个，提到三角函数，大家自然就想到利用欧拉公式把三角函数转化成复指数形式。然而虽然变成了复指数，它的变量仍然是角度θ，是一个实数。
因此我们要把e^(iθ)整个替换成一个复数z，这样就变成复变函数的积分了。当然变量跟着改变了，那么微分dθ也同样要改变，我们求一下dz就可以得到dθ的表达式了。
这样我们所有东西就都换成复数了，然后我们把这些复数统统挪到原来的函数里面。
至于积分路径，原来的θ表示一个周期，那么如果我换的z=e^(iθ)，其实z就表示的是一个单位圆，对吧。那我只要求复变函数在单位圆内的积分就行了，用留数定理来求就好。
第二种形式的积分更简单，你只需要把原来定积分里的被积函数R(x)的所有x全部改成z。然后就有了复变函数R(z)嘛，求这个R(z)在上半幅平面内的所有奇点处留数之和，再乘2πi就可以了。
为什么是这样呢？我们简单给大家说明一下。无穷区间的广义积分，可以理解为在实轴x上取一条路径，从负无穷到正无穷。
而如果要把它改成与复变函数积分有关的形式，我们可以把这个路径的起点和终点，也就是正无穷跟负无穷连接起来。
当然你直接连无穷可能不太好连，我们可以先取一个定值R把它们连起来，然后让R趋于无穷来分析。
我们知道这个复变函数R(z)在这条闭合曲线，也就是整个半圆弧连带着直径的积分的值，就等于这片半圆内所包围的各奇点的留数之和乘以2πi。
然而我们要求的实变函数的积分只是下面那条直径上的积分，和上面那个半圆弧没什么关系啊。
严谨的数学证明指出，当R趋于无穷时，上面那条半圆弧上积分值就变成了0，因此在整个闭合路径上的积分就等同于下面那条直径上的积分。
而在闭合路径上的积分，就可以用留数定理来算嘛。上面这些分析，大家如果听得懂最好，那么听不懂也没有关系，直接把这个计算的法则记下来就好。
要注意你要求R(z)的奇点，只用求上半复平面的，也就是虚部大于零的奇点处的留数，可别把下面的也带上了。
第三种形式的积分实际上与第二种类似。如果你看见被积函数是有理函数R(x)与三角函数sinx（或cosx）的乘积，那么请你先把三角函数扔出去，
然后把有理函数R(x)全变成R(z)，再给R(z)乘上一个e^(iaz)。这里的a就是sin或者cos的变量里角的倍数，比如sin2x的话a就是2，sin3x的话a就是3之类的。
然后你就去求复变函数R(z)e^(iaz)在整个上半复平面的所有奇点的留数之和再乘以2πi。
求完以后，我们求留数的和通常会得到一个复数。而这个复数的实部就是有理函数与cos的乘积的积分，这个复数的虚部就是有理函数与sin的乘积的积分。
我想这个事大家应该很明了吧，这不就是欧拉公式嘛。
因此如果题目给你给了sin，你就把虚部拉出来；给了cos，你就把实部拉出来。至于求出来的另外一个东西，你也不用管，反正用不上。
所以说为什么被积函数只能有sin或者cos的一个，因为如果两个放一起了，你构造的这个R(z)e^(iaz)这个式子就求不出来了。
理论性的部分我们就说这么多。这三种形式除了第一种比较简单直白，后面两种都需要长篇幅的证明。
尤其是第二、三种上面那个圆弧的积分为0，这个证明还是比较困难的，我们也不给大家说明，大家只要会求积分就好了。实践出真知，我们来看几道例题。

本课我们最重要的内容就是用留数求解积分，包括留数求解复变函数的积分，以及留数求解三种形式的定积分。求解方法大家一定要掌握。还有判断奇点的类型以及极点的级数，大家都要掌握。
此外，本章学习以后，理论上所有我们能见到的复变函数的积分，都可以使用留数定理来做了。柯西积分公式与高阶导数公式，也都只是留数定理的一种特殊形式罢了。
只不过它们的简繁程度有所不同，大家在考试的时候也要学会灵活使用。